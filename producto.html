<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Producto | Delivery Mayorista</title>
  <link rel="stylesheet" href="css/estilos.css" />

  <style>
    /* ===========================
        PRODUCT PAGE LAYOUT
       =========================== */

    main.producto-pagina {
      padding: 40px 16px 60px;
    }

    main.producto-pagina .producto-wrapper {
      max-width: 1200px;
      margin: 0 auto 20px;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 50px;
    }

    /* LEFT SIDE IMAGE */
    .producto-imagen {
      flex: 0 0 45%;
    }

    .producto-imagen img {
      width: 100%;
      height: auto;
      border-radius: 22px;
      object-fit: contain;
      background: #0a0a12;
    }

    /* RIGHT SIDE INFO */
    .producto-info {
      flex: 0 0 45%;
    }

    .producto-acciones {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }

    .btn-secundario,
    .btn-whatsapp,
    .btn-nav {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 12px 18px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 15px;
      text-decoration: none;
      border: none;
    }

    .btn-secundario {
      background: #202432;
      color: #fff;
    }

    .btn-whatsapp {
      background: #1ebe57;
      color: #fff;
      font-weight: 600;
    }

    .producto-nav {
      max-width: 1200px;
      margin: 25px auto 0;
      display: flex;
      gap: 10px;
      justify-content: center;
    }

    .btn-nav {
      background: #202432;
      color: #fff;
    }

    /* ‚≠ê‚≠ê‚≠ê MOBILE ‚Äî SOLO CAMBIAMOS AQU√ç ‚≠ê‚≠ê‚≠ê */
    @media (max-width: 900px) {
      main.producto-pagina .producto-wrapper {
        flex-direction: column;
        gap: 20px;
      }

      .producto-imagen,
      .producto-info {
        width: 100%;
        flex: 1 1 auto;
      }

      .producto-acciones {
        flex-direction: column;
        width: 100%;
      }

      .producto-acciones a {
        width: 100%;
        text-align: center;
      }

      .producto-nav {
        flex-wrap: wrap;
      }
    }
  </style>
</head>

<body>

  <!-- TOPBAR -->
  <header class="topbar">
    <div class="topbar-inner">
      <a href="index.html" class="logo-link">Delivery Mayorista</a>
      <a href="catalogo.html" class="topbar-link">Ver cat√°logo</a>
    </div>
  </header>

  <!-- PRODUCT PAGE -->
  <main class="producto-pagina contenedor">

    <div class="producto-wrapper">

      <!-- IMAGE -->
      <div id="producto-imagen" class="producto-imagen">
        <img id="imagen-principal" src="" alt="producto" />
        <div id="miniaturas" class="miniaturas"></div>
      </div>

      <!-- INFO -->
      <div id="producto-info" class="producto-info"></div>

    </div>

    <!-- NAV -->
    <div id="producto-nav" class="producto-nav"></div>

  </main>

  <!-- FOOTER -->
  <footer class="footer">
    Cat√°logo mayorista ¬∑ Delivery Mayorista
  </footer>


  <!-- ==============================
       üî• PRODUCT JS (FUNCIONA TODO)
       ============================== -->

  <script>
    const BASE_IMG = "https://raw.githubusercontent.com/agustapia3636/deliverymayorista-img/main";

    async function cargarProducto() {
      try {
        const params = new URLSearchParams(window.location.search);
        const codigo = params.get("codigo");

        const infoDiv = document.getElementById("producto-info");

        if (!codigo) {
          infoDiv.innerHTML = "<h2>Producto no encontrado</h2>";
          return;
        }

        const resp = await fetch("productos.json");
        if (!resp.ok) throw new Error("No se pudo cargar productos.json");

        const productos = await resp.json();
        const index = productos.findIndex(p => p.codigo === codigo);

        if (index === -1) {
          infoDiv.innerHTML = "<h2>Producto no encontrado</h2>";
          return;
        }

        const prod = productos[index];

        /* ============ IMAGE ============ */
        const imgPrincipal = document.getElementById("imagen-principal");
        imgPrincipal.src = `${BASE_IMG}/${prod.codigo}.JPG`;
        imgPrincipal.onerror = () => imgPrincipal.src = `${BASE_IMG}/${prod.codigo}.jpg`;

        const miniaturasDiv = document.getElementById("miniaturas");
        miniaturasDiv.innerHTML = "";

        /* ============ INFO ============ */
        const precio = prod.precio
          ? `$ ${Number(prod.precio).toLocaleString("es-AR", { minimumFractionDigits: 2 })}`
          : "";

        infoDiv.innerHTML = `
          <p class="producto-codigo">${prod.codigo}</p>
          <h1 class="producto-titulo">${prod.nombre_corto}</h1>
          ${prod.categoria ? `<p class="producto-categoria">${prod.categoria}</p>` : ""}
          ${prod.descripcion_larga ? `<p class="producto-descripcion">${prod.descripcion_larga}</p>` : ""}
          ${precio ? `<p class="producto-precio">${precio}</p>` : ""}
          <p class="producto-stock">Stock: ${prod.stock} unidades</p>

          <div class="producto-acciones">
            <a href="catalogo.html" class="btn-secundario">‚Üê Volver al cat√°logo</a>
            <a href="${armarLinkWhatsApp(prod)}" target="_blank" class="btn-whatsapp">
              Consultar por WhatsApp
            </a>
          </div>
        `;

        /* ============ NAVIGATION ============ */
        const nav = document.getElementById("producto-nav");
        const anterior = productos[(index - 1 + productos.length) % productos.length];
        const siguiente = productos[(index + 1) % productos.length];

        nav.innerHTML = `
          <button class="btn-nav" onclick="irAProducto('${anterior.codigo}')">‚Üê ${anterior.codigo}</button>
          <button class="btn-nav" onclick="window.location.href='catalogo.html'">Volver al listado</button>
          <button class="btn-nav" onclick="irAProducto('${siguiente.codigo}')">${siguiente.codigo} ‚Üí</button>
        `;
      } catch (e) {
        console.error(e);
      }
    }

    function armarLinkWhatsApp(prod) {
      const precio = prod.precio
        ? `$ ${Number(prod.precio).toLocaleString("es-AR", { minimumFractionDigits: 2 })}`
        : "‚Äî";

      const mensaje = [
        "Hola! Me interesa este producto:",
        "",
        `C√≥digo: ${prod.codigo}`,
        `Producto: ${prod.nombre_corto}`,
        `Precio mayorista: ${precio}`,
        "",
        "¬øMe pas√°s disponibilidad y cantidades m√≠nimas?"
      ].join("\n");

      return `https://wa.me/?text=${encodeURIComponent(mensaje)}`;
    }

    function irAProducto(codigo) {
      window.location.href = `producto.html?codigo=${encodeURIComponent(codigo)}`;
    }

    cargarProducto();
  </script>

</body>
</html>

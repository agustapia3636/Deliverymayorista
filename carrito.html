<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Tu carrito - Delivery Mayorista</title>

<style>
:root {
  --bg-body: #05030c;
  --bg-card: #11101c;
  --texto-principal: #ffffff;
  --texto-secundario: #d4d4f0;
  --texto-suave: #9b9bb5;
  --rosa: #ff007a;
  --rojo: #ff3b3b;
  --verde: #00b341;
  --gris-borde: #2b2a3a;
  --radio-grande: 18px;
  --fuente: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

*{ box-sizing: border-box; margin:0; padding:0; }

body{
  font-family:var(--fuente);
  background: radial-gradient(circle at top,#141327 0,#05030c 55%);
  color:var(--texto-principal);
  min-height:100vh;
}

/* ---------- HEADER ---------- */
header{
  background: linear-gradient(90deg,#ff007a,#ff9800);
  padding:16px 18px 14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  border-bottom-left-radius:18px;
  border-bottom-right-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,0.55);
  position:sticky;
  top:0;
  z-index:20;
}

.logo-texto{
  font-weight:700;letter-spacing:0.06em;font-size:18px;
}

.link-catalogo-header{
  font-size:13px;font-weight:600;text-decoration:none;color:#fff;
  padding:8px 14px;border-radius:999px;background:rgba(0,0,0,0.15);
  border:1px solid rgba(255,255,255,0.25);
}

main{
  max-width:1050px;margin:0 auto;padding:18px 16px 32px;
}

.volver-catalogo a{
  color:#c28cff;text-decoration:none;font-size:14px;
}
.volver-catalogo a:hover{ text-decoration:underline; }

h1.carrito-titulo{
  font-size:26px;margin:10px 2px 18px;font-weight:700;
}

/* ---------- LISTA ITEMS ---------- */
#carrito-lista{
  display:flex;flex-direction:column;gap:22px;margin-bottom:32px;
}

/* ‚≠ê‚≠ê CARD FINAL ‚≠ê‚≠ê */
.carrito-item{
  background:var(--bg-card);
  border-radius:var(--radio-grande);
  padding:32px 28px;                 /* M√ÅS ALTA */
  display:flex;
  flex-direction:column;             /* TODO VERTICAL */
  gap:18px;
  align-items:flex-start;
  box-shadow:0 10px 22px rgba(0,0,0,0.55);
  width:100%;
}

/* IMAGEN */
.carrito-item-img{
  width:90px;height:90px;border-radius:14px;
  background:#05040d;display:flex;align-items:center;justify-content:center;
  overflow:hidden;
}
.carrito-item-img img{ max-width:100%;max-height:100%;object-fit:contain; }

/* BLOQUE SUPERIOR: NOMBRE / COD / STOCK / PRECIOS */
.carrito-item-top{
  display:flex;
  width:100%;
  justify-content:space-between;
  align-items:flex-start;
}

/* TEXTOS */
.carrito-item-textos{
  min-width:0;
}
.carrito-item-nombre{
  font-size:15px;font-weight:600;margin-bottom:2px;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.carrito-item-detalle{
  font-size:14px;color:var(--texto-secundario);line-height:1.25;
}

/* PRECIOS A LA DERECHA ‚Äì UNO DEBAJO DEL OTRO */
.carrito-item-precios{
  font-size:14px;color:var(--texto-secundario);
  display:flex;flex-direction:column;
  text-align:right;gap:2px;white-space:nowrap;
}

/* CONTROLES Y ELIMINAR AL FINAL DE LA CARD */
.carrito-item-bottom{
  display:flex;
  width:100%;
  align-items:center;
  justify-content:space-between;
}

/* BOTONES CANTIDAD */
.carrito-item-controles{
  display:flex;align-items:center;gap:6px;
}
.btn-cant{
  width:32px;height:32px;border-radius:999px;border:none;
  background:var(--rosa);color:#fff;font-size:17px;font-weight:700;
  display:flex;align-items:center;justify-content:center;cursor:pointer;
}
.btn-cant:active{ transform:scale(0.95); }

.carrito-item-cantidad{
  min-width:32px;height:32px;line-height:32px;text-align:center;
  font-size:15px;font-weight:600;background:#fff;color:#111;border-radius:999px;
}

/* BOT√ìN ELIMINAR */
.btn-eliminar{
  border:none;border-radius:999px;
  padding:10px 20px;font-size:15px;font-weight:600;
  background:var(--rojo);color:#fff;cursor:pointer;
}
.btn-eliminar:active{ transform:scale(0.97); }

/* ---------- RESUMEN ---------- */
.carrito-resumen-total{
  font-size:22px;font-weight:700;text-align:center;margin-bottom:6px;
}
.carrito-resumen-aviso{
  font-size:13px;color:var(--texto-suave);text-align:center;margin-bottom:20px;
}

.btn-grande-borde,
.btn-grande-rojo,
.btn-grande-verde{
  width:100%;border-radius:999px;padding:14px 18px;font-size:16px;
  font-weight:600;cursor:pointer;display:flex;align-items:center;
  justify-content:center;margin-bottom:14px;
}
.btn-grande-borde{ background:transparent;color:#fff;border:1px solid var(--gris-borde); }
.btn-grande-rojo{ background:var(--rojo);color:#fff;border:none; }
.btn-grande-verde{ background:var(--verde);color:#fff;border:none;box-shadow:0 0 18px rgba(0,179,65,0.6); }

</style>
</head>

<body>

<header>
  <div class="logo-texto">DELIVERY MAYORISTA</div>
  <a href="catalogo.html" class="link-catalogo-header">Ver cat√°logo</a>
</header>

<main>
  <div class="volver-catalogo">
    <a href="catalogo.html">&larr; Ir al cat√°logo</a>
  </div>

  <h1 class="carrito-titulo">Tu carrito</h1>

  <div id="carrito-lista"></div>

  <section class="carrito-resumen">
    <p class="carrito-resumen-total">
      Total (<span id="carrito-total-items">0</span> productos): 
      $<span id="carrito-total-precio">0</span>
    </p>
    <p class="carrito-resumen-aviso">
      Total estimado sujeto a stock y √∫ltimas actualizaciones.
    </p>

    <button class="btn-grande-borde" id="btn-seguir">‚Üê Seguir comprando</button>
    <button class="btn-grande-rojo" id="btn-vaciar">Vaciar carrito</button>
    <button class="btn-grande-verde" id="btn-whatsapp">Enviar pedido por WhatsApp</button>
  </section>
</main>

<script>
const CLAVE = "dm_carrito";

function leer(){ try{ return JSON.parse(localStorage.getItem(CLAVE))||[] }catch(e){ return [] } }
function guardar(c){ localStorage.setItem(CLAVE,JSON.stringify(c)) }

function precio(n){
  return Number(n||0).toLocaleString("es-AR",{minimumFractionDigits:0});
}

function render(){
  const lista = document.getElementById("carrito-lista");
  const tItems = document.getElementById("carrito-total-items");
  const tPrecio = document.getElementById("carrito-total-precio");

  const car = leer();
  lista.innerHTML = "";
  if(!car.length){
    tItems.textContent="0";tPrecio.textContent="0";
    lista.innerHTML=`<div style="text-align:center;padding:20px;color:#ccc">Carrito vac√≠o</div>`;
    return;
  }

  let totalItems=0,totalPrecio=0;

  car.forEach((it,i)=>{
    const cod = it.codigo||it.Codigo||"";
    const nom = it.nombre||it["Nombre Corto"]||"SIN NOMBRE";
    const stock = it.stock||10;
    const precioU = Number(it.precioMayorista||it.precio||0);
    const cant = Number(it.cantidad||1);

    totalItems+=cant;
    totalPrecio+=precioU*cant;

    const card=document.createElement("article");
    card.className="carrito-item";

    card.innerHTML=`
      <div class="carrito-item-top">
        <div class="carrito-item-img">
          <img src="${it.img||it.Imagen||''}">
        </div>

        <div class="carrito-item-textos">
          <p class="carrito-item-nombre">${nom}</p>
          <p class="carrito-item-detalle">Cod: ${cod}</p>
          <p class="carrito-item-detalle">Stock disponible: ${stock}</p>
        </div>

        <div class="carrito-item-precios">
          <span>Unitario: $${precio(precioU)}</span>
          <span>Subtotal: $${precio(precioU*cant)}</span>
        </div>
      </div>

      <div class="carrito-item-bottom">
        <div class="carrito-item-controles">
          <button class="btn-cant menos" data-i="${i}">‚àí</button>
          <span class="carrito-item-cantidad">${cant}</span>
          <button class="btn-cant mas" data-i="${i}">+</button>
        </div>

        <button class="btn-eliminar" data-i="${i}">Eliminar</button>
      </div>
    `;

    lista.appendChild(card);
  });

  tItems.textContent=totalItems;
  tPrecio.textContent=precio(totalPrecio);

  document.querySelectorAll(".menos").forEach(b=>b.onclick=()=>cambiar(b.dataset.i,-1));
  document.querySelectorAll(".mas").forEach(b=>b.onclick=()=>cambiar(b.dataset.i,1));
  document.querySelectorAll(".btn-eliminar").forEach(b=>b.onclick=()=>eliminar(b.dataset.i));
}

function cambiar(i,d){
  const car=leer();
  car[i].cantidad=Math.max(1,(car[i].cantidad||1)+d);
  guardar(car);render();
}
function eliminar(i){
  const car=leer();car.splice(i,1);guardar(car);render();
}

document.getElementById("btn-vaciar").onclick=()=>{ guardar([]);render() }
document.getElementById("btn-seguir").onclick=()=>{ location.href="catalogo.html" }
document.getElementById("btn-whatsapp").onclick=()=>{
  const car=leer(); if(!car.length)return;
  let txt="Hola! Pedido:%0A%0A";
  car.forEach(it=>{
    const cant=it.cantidad||1;
    const pu=Number(it.precio||it.precioMayorista||0);
    txt+=`‚Ä¢ ${it.codigo} - ${it.nombre} x ${cant}u = $${precio(pu*cant)}%0A`;
  });
  txt+=`%0AüîπTotal: $${document.getElementById("carrito-total-precio").textContent}`;
  window.open("https://wa.me/5491112345678?text="+txt);
};

render();
</script>

</body>
</html>